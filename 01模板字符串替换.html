<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>vue源码解析</title>
</head>
<body>
       <div id="root">
            <div>
                 <p>{{ name }} -- {{ message }} 22</p>
            </div>
            <div>{{ name }}</div>
            <div>{{ message }}</div>
        </div>
       <script>
          let rkh = /\{\{(.+?)\}\}/g;
          let data = {
              name: 'xlongwang',
              message: '这是一个2消息'
          }

          let tmpNode = document.querySelector('#root')
          
          function compiler (template, datas){
               let childNodes = template.childNodes; 

               for(let i = 0; i < childNodes.length; i++ ){
                   let type = childNodes[i].nodeType;
 
                   if( type === 3 ){
                        let txt = childNodes[ i ].nodeValue;
                        txt = txt.replace(rkh, function( _ , g ) {
                            let key = g.trim()  
                            return data[key]
                        })
                        childNodes[i].nodeValue = txt
                    }else if ( type === 1){
                        compiler( childNodes[ i ], data );
                    }
               }
          }
          let generateNode = tmpNode.cloneNode( true )
          compiler(generateNode, data)
          tmpNode.parentNode.replaceChild(generateNode, tmpNode)
          

       </script>
</body>
</html>